t.test(parentals$ar ~ parentals$genotype)
t.test(parentals$round ~ parentals$genotype)
t.test(parentals$solidity ~ parentals$genotype)
het.e2 <- subset(hetadata, genotype!="3130")
het.e2 <- subset(hetdata, genotype!="3130")
t.test(parentals$area ~ parentals$genotype)
t.test(het.e2$area ~ het$genotype)
t.test(het.e2$area ~ het.e2$genotype)
t.test(het.e2$circ. ~ het.e2$genotype)
het.wt <- subset(hetdata, genotype!="e2")
t.test(het.wt$area ~ het.wt$genotype)
t.test(het.wt$circ ~ het.wt$genotype)
head(parentals)
t.test(het.ar$ ~ het.wt$genotype)
t.test(het.wt$ar ~ het.wt$genotype)
t.test(het.wt$round ~ het.wt$genotype)
t.test(het.wt$solidity ~ het.wt$genotype)
graph.area <- ddply(hetdata, .(genotype), summarise,
N		=length(area),
area	=mean(area),
sd		=sd(area),
se		=sd(area) / sqrt(length(area)) )
head(graph.area)
head(graph.area)
c <- ggplot(graph.area, aes(x=genotype, y=area)))
c <- ggplot(graph.area, aes(x=genotype, y=area))
c + geom_bar()
c + geom_bar() +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="white")
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("greenyellow", "green3", "black"))
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="white")
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("greenyellow", "green3", "black")) +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="white")
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("blue", "red", "purple")) +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
scale_fill_manual(values=c("lightblue", "lightred", "lightpurple")) +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("lightblue", "lightred", "lightpurple")) +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("dodgerblue2", "firebrick3", "darkorchid1")) +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
setwd("~/Desktop/het population analysis")
hetdata <- read.csv("Data.hetpop.csv")
head(hetdata)
summary(hetdata)
#can not for the life of me get the perim. to read as number, so fuck it.
qqnorm(hetdata$area)
qqline(hetdata$area)
parentals <- subset(hetdata, genotype!="het")
head(parentals)
t.test(parentals$area ~ parentals$genotype)
t.test(parentals$solidity ~ parentals$genotype)
# all significant between parentals
het.e2 <- subset(hetdata, genotype!="3130")
het.wt <- subset(hetdata, genotype!="e2")
t.test(het.e2$area ~ het.e2$genotype)
t.test(het.e2$circ. ~ het.e2$genotype)
t.test(het.wt$solidity ~ het.wt$genotype)
#there is a significant difference between het and wt in the area of solidity
###Visaualization
graph.area <- ddply(hetdata, .(genotype), summarise,
N  	=length(area),
area	=mean(area),
sd		=sd(area),
se		=sd(area) / sqrt(length(area)) )
head(graph.area)
graph. <- ddply(hetdata, .(genotype), summarise,
N    =length(area),
area	=mean(area),
sd		=sd(area),
se		=sd(area) / sqrt(length(area)) )
head(graph.area)
head(hetdata)
graph.circ <- ddply(hetdata, .(genotype), summarise,
N    =length(circ.),
circ	=mean(circ.),
sd		=sd(circ.),
se		=sd(circ.) / sqrt(length(circ.)) )
head(graph.circ.)
head(graph.circ)
graph.circ <- ddply(hetdata, .(genotype), summarise,
N    =length(circ.),
circ	=mean(circ.),
sd		=sd(circ.),
se		=sd(circ.) / sqrt(length(circ.)) )
head(graph.circ)
head(graph.circ)
graph.circ <- ddply(hetdata, .(genotype), summarise,
N    =length(circ.),
circ	=mean(circ.),
sd		=sd(circ.),
se		=sd(circ.) / sqrt(length(circ.)) )
library(plyr)
graph.circ <- ddply(hetdata, .(genotype), summarise,
N    =length(circ.),
circ	=mean(circ.),
sd		=sd(circ.),
se		=sd(circ.) / sqrt(length(circ.)) )
head(graph.circ)
graph.area$measurement <- "area"
head(graph.area)
graph.circ$measurement <- "circ."
head(graph.circ)
head(hetdata)
graph.ar <- ddply(hetdata, .(genotype), summarise,
N    =length(ar),
ar  =mean(ar),
sd		=sd(ar),
se		=sd(ar) / sqrt(length(ar)) )
graph.ar$measurement <- "ar"
head(graph.ar)
graph.solidity <- ddply(hetdata, .(genotype), summarise,
N    =length(solidity),
solidity  =mean(solidity),
sd  	=sd(solidity),
se		=sd(solidity) / sqrt(length(solidity)) )
graph.solidity$measurement <- "solidity"
head(graph.solidity)
head(hetdata)
mergehetdata <- rbind(graph.solidity, graph.area, graph.ar, graph.circ)
mergehetdata <- rbind(graph.solidity, graph.area, graph.ar, graph.circ)
graph.solidity
graph.area
graph.ar
graph.circ
c <- ggplot(graph.circ, aes(x=genotype, y=circ))
c + geom_bar()
library(ggplot)
library(ggplot2)
c <- ggplot(graph.circ, aes(x=genotype, y=circ))
c + geom_bar()
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("dodgerblue2", "firebrick3", "darkorchid1")) +
geom_errorbar(aes(ymin=area-se, ymax=area+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("dodgerblue2", "firebrick3", "darkorchid1")) +
geom_errorbar(aes(ymin=circ-se, ymax=circ+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
library(ggplot2)
c <- ggplot(graph.solidity, aes(x=genotype, y=solidity))
c + geom_bar()
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("dodgerblue2", "firebrick3", "darkorchid1")) +
geom_errorbar(aes(ymin=solidity-se, ymax=solidity+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
summary(hetdata)
hetdata <- subset(hetdata, leaf=="4")
parentals <- subset(hetdata, genotype!="het")
head(parentals)
parentals <- subset(hetdata, genotype!="het")
head(parentals)
t.test(parentals$area ~ parentals$genotype)
t.test(parentals$solidity ~ parentals$genotype)
# all significant between parentals
het.e2 <- subset(hetdata, genotype!="3130")
het.wt <- subset(hetdata, genotype!="e2")
t.test(het.e2$area ~ het.e2$genotype)
t.test(het.e2$circ. ~ het.e2$genotype)
t.test(het.wt$solidity ~ het.wt$genotype)
#there is a significant difference between het and wt in the area of solidity
###Visaualization
graph.area <- ddply(hetdata, .(genotype), summarise,
N  	=length(area),
area	=mean(area),
sd		=sd(area),
se		=sd(area) / sqrt(length(area)) )
head(graph.area)
graph.area <- ddply(hetdata, .(genotype), summarise,
N    =length(area),
area	=mean(area),
sd		=sd(area),
se		=sd(area) / sqrt(length(area)) )
graph.area$measurement <- "area"
head(graph.area)
graph.circ <- ddply(hetdata, .(genotype), summarise,
N    =length(circ.),
circ	=mean(circ.),
sd		=sd(circ.),
se		=sd(circ.) / sqrt(length(circ.)) )
graph.circ$measurement <- "circ."
head(graph.circ)
graph.ar <- ddply(hetdata, .(genotype), summarise,
N    =length(ar),
ar  =mean(ar),
sd		=sd(ar),
se		=sd(ar) / sqrt(length(ar)) )
graph.ar$measurement <- "ar"
head(graph.ar)
graph.ar <- ddply(hetdata, .(genotype), summarise,
N    =length(ar),
ar  =mean(ar),
sd  	=sd(ar),
se		=sd(ar) / sqrt(length(ar)) )
graph.ar$measurement <- "ar"
head(graph.ar)
graph.solidity <- ddply(hetdata, .(genotype), summarise,
N    =length(solidity),
solidity  =mean(solidity),
sd  	=sd(solidity),
se		=sd(solidity) / sqrt(length(solidity)) )
graph.solidity$measurement <- "solidity"
head(graph.solidity)
mergehetdata <- rbind(graph.solidity, graph.area, graph.ar, graph.circ)
library(ggplot2)
c <- ggplot(graph.solidity, aes(x=genotype, y=solidity))
c + geom_bar()
c + geom_bar(aes(fill=genotype)) +
scale_fill_manual(values=c("dodgerblue2", "firebrick3", "darkorchid1")) +
geom_errorbar(aes(ymin=solidity-se, ymax=solidity+se), #errorbars
width=.2,                    # Width of the error bars
colour="black")
qqnorm(hetdata$area)
qqline(hetdata$area)
hetdata <- subset(hetdata, leaf=="4")
parentals <- subset(hetdata, genotype!="het")
head(parentals)
t.test(parentals$area ~ parentals$genotype)
t.test(parentals$solidity ~ parentals$genotype)
# all significant between parentals
het.e2 <- subset(hetdata, genotype!="3130")
het.wt <- subset(hetdata, genotype!="e2")
t.test(het.e2$area ~ het.e2$genotype)
t.test(het.e2$circ. ~ het.e2$genotype)
t.test(het.wt$area ~ het.wt$genotype)
t.test(het.wt$circ. ~ het.wt$genotype)
t.test(het.wt$solidity ~ het.wt$genotype)
t.test(het.wt$area ~ het.wt$genotype)
read.csv("Data.hetpop.csv")
hetdata <- read.csv("Data.hetpop.csv")
head(hetdata)
summary(hetdata)
subset(hetdata, genotype=="3103")
3130.all <- subset(hetdata, genotype=="3130")
wt.all <- subset(hetdata, genotype=="3130")
head(wt.all)
levels(plant)
levels(wt.all$plant)
factor(wt.all$plant)
wt.all <- subset(hetdata, genotype=="3130")
head(wt.all)
w2 <- subset(wt.all, plant == "w2"
w2 <- subset(wt.all, plant == "w2")
w2 <- subset(wt.all, plant == "w2")
w2
head(wt.all)
w2 <- subset(wt.all, plant == "w11")
w11 <- subset(wt.all, plant == "w11")
w11
head(hetdata)
duplicated(hetdata)
wt.all <- subset(hetdata, genotype=="3130")
head(wt.all)
w11 <- subset(wt.all, plant == "w11")
w11
summary(w11$leaf)
wt.all <- subset(hetdata, genotype=="3130")
head(wt.all)
hetdata <- read.csv("Data.hetpop.csv")
head(hetdata)
summary(hetdata)
duplicated(hetdata)
wt.all <- subset(hetdata, genotype=="3130")
head(wt.all)
w11 <- subset(wt.all, plant == "w11")
summary(w11$leaf)
mean(w11$leaf)
w11.L1 <- subset(w11, leaf=="L1")
w11.L1
w11.L2 <- subset(w11, leaf=="L2")
w11.L2
w11.L3 <- subset(w11, leaf=="L2")
w11.L3 <- subset(w11, leaf=="L3")
w11.L3
final.data$L1 <- sum(w11.L3$area)
as.dataframe(final.data)
sum(w11.L3$area)
w11.L3.sum <- sum(w11.L3$area)
w11.L3.sum <- sum(w11.L3$area)
w11.L3.sum
w11.L4 <- subset(w11, leaf=="L4")
w11.L4
w11.L3.sum <- sum(w11.L3$area)
w11.L3.sum
setwd("~/Dropbox/Research/e2/e2_phyllotaxy/population2/angleAnalysis2/august2015")
angleData <- read.csv("anglePopulation1&2&3.csv")
head(angleData)
angleDataLeaf <- angleData[,c(2,3,4,5,6)]
angleDataSub <- subset(angleDataLeaf, leaf != "L7L8")
levels(angleDataSub$genotype) <- c("WT","e-2")
levels(angleDataSub$genotype)
levels(angleDataSub$genotype) <- c("WT","e-2", "pin1gfp.e2")
angleData <- read.csv("anglePopulation1&2&3.csv")
head(angleData)
angleDataLeaf <- angleData[,c(2,3,4,5,6)]
angleDataSub <- subset(angleDataLeaf, leaf != "L7L8")
levels(angleDataSub$genotype) <- c("WT","e-2", "pin1gfp.e2")
library(ggplot2)
ggplot(angleDataSub, aes(leaf, angle, color = genotype)) +
geom_boxplot(outlier.size = 0) +
geom_point(position = "jitter", alpha = .2) +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
geom_hline(yintercept=137.5, linetype = "dotted") +
scale_y_continuous(breaks=c(50, 100, 137.5, 150, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none")
library(reshape)
head(angleData)
angleDataPlant <- angleData[,-c(6,1)]
castAngleData <- dcast(angleDataPlant, plant + genotype ~ leaf, value.var = "angle")
head(castAngleData)
head(angleData)
angleDataPlant <- angleData[,-c(6,1)]
castAngleData <- dcast(angleDataPlant, plant + genotype ~ leaf, value.var = "angle")
library(reshape2)
castAngleData <- dcast(angleDataPlant, plant + genotype ~ leaf, value.var = "angle")
head(castAngleData)
```
How many of each genotype
```{r}
summary(castAngleData$genotype)
wtAngle <- subset(castAngleData, genotype == "3130")
#Spiral WT
wtSpiralL34 <- subset(wtAngle, L3L4 <= 150 & L3L4 >= 120)
dim(wtSpiralL34) #75
wtDecL34 <- subset(wtAngle, L3L4 <= 195 & L3L4 >= 165)
dim(wtDecL34) #5
##e2
e2Angle <- subset(castAngleData, genotype == "e2")
dim(e2Angle)
#Spiral e2
e2SpiralL34 <- subset(e2Angle, L3L4 <= 150 & L3L4 >= 120)
dim(e2SpiralL34) #18
e2DecL34 <- subset(e2Angle, L3L4 <= 195 & L3L4 >= 165)
dim(e2DecL34) #39
39/88
44+39
83/88
#How many plant were recorded for L3L4
summary(is.na(e2Angle$L3L4)) #88
#Other
88 - 39 -18 #=31
```
A few other ways to look at this data
```{r}
ggplot(angleDataSub, aes(angle, fill = leaf)) +
geom_bar() +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
scale_x_continuous(breaks=c(50, 90, 137.5, 180, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none"
)
angleDataSubL12 <- subset(angleDataSub, leaf == "L1L2")
angleDataSubL23 <- subset(angleDataSub, leaf == "L2L3")
angleDataSubL34 <- subset(angleDataSub, leaf == "L3L4")
angleDataSubL45 <- subset(angleDataSub, leaf == "L4L5")
angleDataSubSub <- rbind(angleDataSubL12, angleDataSubL23, angleDataSubL34, angleDataSubL45)
ggplot(angleDataSubSub, aes(angle)) +
geom_bar() +
facet_grid(leaf~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
scale_x_continuous(breaks=c(50, 90, 137.5, 180, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
strip.text.y = element_text(size = 18),
strip.background = element_rect(fill="#b0c4de"),
legend.position="none"
)
ggplot(angleDataSubSub, aes(angle)) +
geom_bar() +
facet_grid(.~genotype) +
theme_bw() +
scale_x_continuous(breaks=c(50, 90, 137.5, 180, 200)) +
geom_vline(xintercept=137.5, color = "red", linetype= "longdash") +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
strip.text.y = element_text(size = 18),
strip.background = element_rect(fill="#b0c4de"),
legend.position="none"
)
ggplot(angleDataSub, aes(angle)) +
geom_density() +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
scale_x_continuous(breaks=c(50, 90, 137.5, 180, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none"
)
ggplot(angleDataSub, aes(angle, fill = leaf, alpha = 50)) +
geom_density() +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
scale_x_continuous(breaks=c(50, 90, 137.5, 180, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20)
)
library(ggplot2)
ggplot(angleDataSub, aes(leaf, angle, color = genotype)) +
geom_boxplot(outlier.size = 0) +
geom_point(position = "jitter", alpha = .2) +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
geom_hline(yintercept=137.5, linetype = "dotted") +
scale_y_continuous(breaks=c(50, 100, 137.5, 150, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none")
ggplot(angleDataSub, aes(leaf, angle)) +
geom_boxplot(outlier.size = 0) +
geom_point(position = "jitter", alpha = .2) +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
geom_hline(yintercept=137.5, linetype = "dotted") +
scale_y_continuous(breaks=c(50, 100, 137.5, 150, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none")
levels(angleDataSub$genotype) <- c("WT","e-2", "complemented e-2")
```
Make a boxplot that illustrates angle divergence.
```{r}
library(ggplot2)
ggplot(angleDataSub, aes(leaf, angle)) +
geom_boxplot(outlier.size = 0) +
geom_point(position = "jitter", alpha = .2) +
facet_grid(.~genotype) +
scale_color_brewer(palette="Dark2") +
theme_bw() +
geom_hline(yintercept=137.5, linetype = "dotted") +
scale_y_continuous(breaks=c(50, 100, 137.5, 150, 200)) +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none")

geom_line() +
xlab("Generations") +
ylab("Focal Allele Frequency") +
labs(colour = "")
install.packages("testdat")
install.packages("testthat")
library(testthat)
setwd("~/Downloads/automation/example-manuscript")
library(ggplot2)
library(reshape2)
library(plyr)
#Read in datasets
spiral <- read.csv("../data/phyllotaxyScoring_11March2015.csv")
setwd("~/Dropbox/Research/e2/e2_complementationTest/1/analysis")
spiral <- read.csv("../data/phyllotaxyScoring_11March2015.csv")
leaf <- read.csv("../data/complexityFull_15March2015.csv")
head(spiral)
dim(spiral)
head(leaf)
dim(leaf)
#Merge
full <- merge(spiral, leaf, by = "id")
head(full)
dim(full)
#There are four types of plants
levels(full$line)
is.na(full$line)
#We need to get rid of the plants that full$id == Na.
fullsub1 <- subset(full, !is.na(full$line))
levels(fullsub1$line)
names(fullsub1)
head(fullsub1)
#PHYLLOTAXY
#Summarize
leaf.graph <-ddply(fullsub1, .(line),summarise,
nspiral= length(phenotype[phenotype=="spiral"]),
nNoSpiral = length(phenotype[phenotype=="noSpiral"]),
percentSpiral= nspiral/(nspiral+nNoSpiral))
#plot
ggplot(leaf.graph, aes(reorder(line, percentSpiral), percentSpiral)) +
geom_bar(stat ="identity") +
theme_bw() +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none") +
ylab("percent spiral")  +
xlab("genotype")
head(leaf.graph)
head(leaf.graph)
leaf.graph.sub <- leaf.graph[c(-2),]
leaf.graph.sub$line <- gsub("PIN1::GFP", "e2/e2, +PIN1::GFP", leaf.graph.sub$line)
ggplot(leaf.graph.sub, aes(reorder(line, percentSpiral), percentSpiral)) +
geom_bar(stat ="identity") +
theme_bw() +
theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
legend.position="none") +
ylab("percent spiral")  +
xlab("genotype")
setwd("~/Dropbox/Research/e2/e2_meristemSize/analysis")
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.txt")
head(merSize)
merSize <- read.txt("../data/5June2015/widthHeight_5June2015.txt")
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.txt")
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.csv")
head(merSize)
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.csv")
head(merSize)
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.csv")
head(merSize)
merSize <- merSize[, -1]
head(merSize)
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.csv")
head(merSize)
merSize <- merSize[, -1]
```
Visualization
library(ggplot2)
head(merSize)
ggplot(merSize, aes(genotype, height)) + geom_bar()
ggplot(merSize, aes(genotype, height)) + geom_bar(stat="identity")
ggplot(merSize, aes(genotype, height)) + geom_plot(stat="identity")
ggplot(merSize, aes(genotype, height)) + geom_point(stat="identity")
ggploy(merSize, aes(genotype, width)) + geom_point(stat= "identity")
ggplot(merSize, aes(genotype, width)) + geom_point(stat= "identity")
ggplot(merSize, aes(genotype, height)) + geom_boxplot(stat="identity")
ggplot(merSize, aes(genotype, height)) + geom_boxplot()
ggplot(merSize, aes(genotype, width)) + geom_boxplot()
ggplot(merSize, aes(genotype, height)) + geom_boxplot()
ggplot(merSize, aes(width, height)) + geom_point(stat="identity")
ggplot(merSize, aes(width, height)) +
geom_point(stat="identity") +
facet_grid(.~genotype)
ggplot(merSize, aes(genotype, width))
+ geom_boxplot()
ggplot(merSize, aes(genotype, width)) +
geom_boxplot()
t.test(merSize$width, merSize$genotype)
t.test(merSize$genotype, merSize$width)
t.test(merSize$genotype, merSize$width)
t.test(merSize$genotype ~ merSize$width)
t.test(merSize$width ~ merSize$genotype)
t.test(merSize$height~ merSize$genotype)
e2 <- subset(merSize, gentype == "e2")
e2 <- subset(merSize, genotype == "e2")
wt <- subset(merSize, genotype == "wt")
var.test(e2$height, wt$height)
var.test(e2$height, wt$height, alternative="two.sided"))
var.test(e2$height, wt$height, alternative="two.sided")
t.test(merSize$width ~ merSize$genotype)
t.test(merSize$height ~ merSize$genotype, var.eq=F)
t.test(merSize$height ~ merSize$genotype, var.eq=F, alt = "two-sided")
t.test(merSize$height ~ merSize$genotype, var.eq=F, alt = "two.sided")
var(e2$height)
var(wt$height)
var.test(e2$height, wt$height, alternative="two.sided")
install.packages("car")
library(car)
car(e2$height, wt$height)
levineTest(e2$height, wt$height)
leveneTest(e2$height, wt$height)
leveneTest(merSize$height, merSize$genotype)
var.test(e2$height, wt$height, alternative="two.sided")
leveneTest(merSize$height, merSize$genotype)
var(e2$height)
var(wt$height)
var(e2$height) / var(wt$height)
geom_boxplot(alpha = .5) + geo
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .5) +
geom_point()
geom_point(position = "dodge")
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .5) +
geom_point(position = "dodge")
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .5) +
geom_point(position = "dodge", alpha = .5)
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .5) +
geom_point(position = "jitter", alpha = .5)
customTheme <- list(theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20)) )
customTheme
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .5) +
geom_point(position = "jitter", alpha = .5) +
customTheme
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .5) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
customTheme
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
customTheme
?gsub
merSize <- gsub("e2", "sopin1a")
merSize <- gsub("e2", "sopin1a", merSize$genotype)
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
customTheme
head(merSize)
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.csv")
head(merSize)
merSize <- merSize[, -1]
head(merSize)
merSize$genotype <- gsub("e2", "sopin1a", merSize$genotype)
head(merSize)
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
customTheme
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
scale_x_discrete(limits=c("wt","sopin1a")) +
customTheme
merSize$genotype <- gsub("wt", "WT", merSize$genotype)
head(merSize)
Height is significantly larger in *e-2*, (p = 0.0001983).
```{r}
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
scale_x_discrete(limits=c("wt","sopin1a")) +
customTheme
merSize <- read.csv("../data/5June2015/widthHeight_5June2015.csv")
head(merSize)
merSize <- merSize[, -1]
merSize$genotype <- gsub("e2", "sopin1a", merSize$genotype)
merSize$genotype <- gsub("wt", "WT", merSize$genotype)
head(merSize)
merSize
wt <- subset(merSize, genotype == "WT")
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
customTheme
cbPalette <- c("#999999","#56B4E9", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(merSize, aes(genotype, height, color = genotype)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme
cbPalette <- c(#56B4E9","#999999", "
cbPalette <- c(#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbPalette <- c(#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
q
cbPalette <- c(#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbPalette <- c("#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbPalette <- c("#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
cbPalette <- c("#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
ggplot(merSize, aes(genotype, height) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5, color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .4) +
geom_point(position = "jitter", alpha = .5, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme
ggplot(merSize, aes(genotype, width)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme
t.test(merSize$width ~ merSize$genotype, var.eq=F, alt = "two.sided")
t.test(merSize$width ~ merSize$genotype, var.eq=F, alt = "two.sided")
###Test for variance
e2 <- subset(merSize, genotype == "e2")
wt <- subset(merSize, genotype == "WT")
# Variance is over 5 times greater in e-2
var(e2$width)
var(wt$width)
ggplot(merSize, aes(genotype, width)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_
e2 <- subset(merSize, genotype == "sopin1a")
sopin1a <- subset(merSize, genotype == "sopin1a")
wt <- subset(merSize, genotype == "WT")
# Variance is over 5 times greater in e-2
var(sopin1a$width)
var(WT$width)
var(wt$width)
#Here are two different tests for difference in variance.
var.test(sopin1a$width, wt$width, alternative="two.sided")
leveneTest(merSize$width, merSize$genotype)
leveneTest(merSize$width, merSize$genotype)
merSize$genotype
leveneTest(merSize$width, merSize$genotype)
var.test(sopin1a$height, wt$height, alternative="two.sided")
leveneTest(merSize$height, merSize$genotype)
leveneTest(merSize$width, merSize$genotype)
library(reshape2)
head(merSize)
mdata <- melt(merSize, id=c("Label","genotype"))
head(m)
head(mdata)
ggplot(mdata, aes(genotype, value)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme +
facet_grid(.~variable)
ggplot(mdata, aes(genotype, value)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme +
ylab("Size (mm)")
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
ylab("Size (mm)") +
customTheme
ggplot(mdata, aes(genotype, value)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme +
ylab("Size (mm)")
facet_grid(.~variable)
head(merSize)
mdata <- melt(merSize, id=c("Label","genotype"))
head(mdata)
ggplot(mdata, aes(genotype, value)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme +
ylab("Size (mm)")
ggplot(mdata, aes(genotype, value)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme +
ylab("Size (mm)") +
facet_grid(.~variable)
ggplot(mdata, aes(genotype, value)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
customTheme +
ylab("size (mm)") +
facet_grid(.~variable)
setwd("~/Dropbox/Research/e2/e2_meristemSize/analysis")
library(ggplot2)
library(car)
library(reshape2)
```
```{r}
##ggplot custom theme
cbPalette <- c("#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
customTheme <- list(theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20),
legend.position="none") )
```
```{r}
merSize <- read.csv("../data/widthHeight_all.csv")
head(merSize)
merSize <- merSize[, -1]
merSize$genotype <- gsub("e2", "sopin1a", merSize$genotype)
merSize$genotype <- gsub("wt", "WT", merSize$genotype)
head(merSize)
summary(merSize)
```
##Visualization
###Height
Height is significantly larger in *e-2*. There is also significant
```{r}
ggplot(merSize, aes(genotype, height)) +
geom_boxplot(alpha = .7) +
geom_point(position = "jitter", alpha = .6, aes(color = genotype)) +
theme_bw() +
scale_x_discrete(limits=c("WT","sopin1a")) +
scale_color_manual(values=cbPalette) +
ylab("size (mm)") +
customTheme
t.test(merSize$height ~ merSize$genotype, var.eq=F, alt = "two.sided")
###Test for variance
sopin1a <- subset(merSize, genotype == "sopin1a")
wt <- subset(merSize, genotype == "WT")
# Variance is over 5 times greater in e-2
var(sopin1a$height)
var(wt$height)
?var
var.test(sopin1a$height, wt$height, alternative="two.sided")
leveneTest(merSize$height, merSize$genotype)
sopin1a <- subset(merSize, genotype == "sopin1a")
wt <- subset(merSize, genotype == "WT")
t.test(merSize$height ~ merSize$genotype, var.eq=F, alt = "two.sided")
t.test(merSize$width ~ merSize$genotype, var.eq=F, alt = "two.sided")
mean(sopin1a$height)
sd(sopin1a$height)
sd(sopin1a$height)
sd(wt$height)
sd(sopin1a$width)
sd(wt$width)
setwd("~/Dropbox/Research/e2/e2_leaf/e2_leafShapeAnalysis/leafShapeAnalysis1.imageJ/R")
library(tidyr)
library(ggplot2)
##ggplot custom theme
cbPalette <- c("#56B4E9","#999999", "#E69F00", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
customTheme <- list(theme(axis.title.x = element_text(face="bold", size=30),
axis.title.y = element_text(face="bold", size=30),
axis.text.x  = element_text(size=16),
axis.text.y  = element_text(size=16),
legend.title = element_text(size=30),
legend.text = element_text(size=20),
strip.text.x = element_text(size = 20),
strip.text.y = element_text(size = 20),
legend.position="none",
strip.background = element_rect(fill="#b0c4de"))
)
```
```{r}
leafArea <- read.csv("../data/leafArea_30June2015.csv")
head(leafArea)
```
Clean Up.  I used `getArea.ijm` macros to get the the areas from binary .bmp files, but in order to achieve this I had to click in multiple areas of the same file to ensure I was able to grab the leaf using the magic wand tool. Therefore I have two measurements per file.  I need to first get rid of any measurement below 3 cm squared. Then get rid of any double measurements.
```{r}
dim(leafArea)
leafArea2 <- subset(leafArea, Area  >= 3.0)
leafArea2 <- subset(leafArea2, Area  <= 200)
dim(leafArea2)
```
Now time to get rid of the duplicate names.
```{r}
names(leafArea2)
leafArea3 <- subset(leafArea2,!duplicated(leafArea2$Label))
dim(leafArea3)
head(leafArea3, 500)
```
We are left with 1230, and there are a total of 1,430 files.  For the interest of not spending too much time on this I am just going to go ahead and forget about those.
leafArea3$genotype <- ifelse(grepl("_E", leafArea3$Label, ignore.case = T), "e2",
ifelse(grepl("_R", leafArea3$Label, ignore.case = T), "WT", "WT"))
#Make ID column
leafArea4 <- separate(data = leafArea3, col = Label, into = c("Leaf", "ID"), sep = "_")
colnames(leafArea4)
head(leafArea4)
head(leafArea4)
head(leafArea4)
ggplot(leafArea4, aes(genotype, Round)) +
geom_boxplot(outlier.shape = NA) +
geom_point(alpha = .2, position = "jitter", aes(color = genotype)) +
scale_x_discrete(limits=c("WT","e2")) +
scale_color_manual(values=cbPalette) +
facet_grid(.~Leaf) +
theme_bw() +
ylab(expression(paste("perim. ", "c", m^2, sep=""))) +
customTheme
```
leafArea4
head(leafArea4)
library(reshape2)
melt(leafArea4, id.vars = c("Leaf", "ID", "genotype"))
melted <- melt(leafArea4, id.vars = c("Leaf", "ID", "genotype"))
head(melted)
summarise(group_by(melted, genotype, Leaf, variable),
mean=mean(value), sd=sd(value))
library(reshape2)
summarise(group_by(melted, genotype, Leaf, variable),
mean=mean(value), sd=sd(value))
library(dplyr)
summarise(group_by(melted, genotype, Leaf, variable),
mean=mean(value), sd=sd(value))
summarise(group_by(melted, genotype, variable),
mean=mean(value), sd=sd(value))
summaryLeaf <- summarise(group_by(melted, genotype, variable),
mean=mean(value), sd=sd(value))
castSumLeaf <- dcast(summaryLeaf, genotype ~ variable )
castSumLeaf
castSumLeaf <- dcast(summaryLeaf, genotype ~ variable )
castSumLeaf <- dcast(summaryLeaf, genotype ~ variable, value.var = c("sd", "mean") )
castSumLeaf
summaryLeaf <- summarise(group_by(melted, genotype, variable),
mean=mean(value), sd=sd(value))
castSumLeaf <- dcast(summaryLeaf, genotype ~ variable, value.var = c("sd", "mean") )
castSumLeaf <- dcast(summaryLeaf, genotype ~ variable, value.var = "sd")
castSumLeaf <- dcast(summaryLeaf, genotype ~ variable, value.var = "mean")
castSumLeaf.mean <- dcast(summaryLeaf, genotype ~ variable, value.var = "mean")
castSumLeaf.sd <- dcast(summaryLeaf, genotype ~ variable, value.var = "sd")
castSumLeaf.sd
castSumLeaf.mean
castSumLeaf.sd
head(melted)
